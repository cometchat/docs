---
title: "Integrating Threads in Android with CometChat UIKit"
sidebarTitle: "Android Threaded Messaging"
---

Implement threaded replies in your Android chat app by integrating CometChat’s UI Kit components—allowing users to reply to specific messages within a focused sub-conversation.

## Table of Contents

1. [Overview](#overview)  
2. [Prerequisites](#prerequisites)  
3. [Components](#components)  
4. [Integration Steps](#integration-steps)  
   - [Add Thread Layout](#add-thread-layout)  
   - [Set up ThreadMessageActivity](#set-up-threadmessageactivity)  
   - [Create ThreadMessageViewModel](#create-threadmessageviewmodel)  
   - [Hook Thread Entry from Message List](#hook-thread-entry-from-message-list)  
5. [Implementation Flow](#implementation-flow)  
6. [Customization Options](#customization-options)  
7. [Filtering / Edge Cases](#filtering--edge-cases)  
8. [Error Handling / Blocked-User Handling](#error-handling--blocked-user-handling)  
9. [Group vs. User-Level Differences](#group-vs-user-level-differences)  
10. [Summary / Feature Matrix](#summary--feature-matrix)  
11. [Next Steps & Further Reading](#next-steps--further-reading)  
12. [Best Practices Recap](#best-practices-recap)

## Overview

Threaded replies allow users to respond directly to a specific message in a one-on-one or group chat, improving context and clarity. Users tap a message → enter thread screen → see parent message + all replies → compose their own response within the thread.

## Prerequisites

- Android Studio setup  
- **CometChat Android UI Kit v5.x** added to your project  
- CometChat **App ID**, **Auth Key**, and **Region** configured  
- Internet permission in **AndroidManifest.xml**  
- Logged-in user (via CometChat login)  
- Working **MessagesActivity** with `CometChatMessageList`

## Components

| Component / Class               | Role                                                     |
|:--------------------------------|:---------------------------------------------------------|
| `CometChatThreadHeader`         | Displays the parent message on the thread screen         |
| `CometChatMessageList`          | Shows all threaded replies                               |
| `CometChatMessageComposer`      | Input field for sending replies                          |
| `ThreadMessageActivity`         | New Activity for thread view                             |
| `ThreadMessageViewModel`        | Fetches and manages thread data (LiveData)               |
| `unblockLayout`                 | UI shown when a user is blocked                          |

## Integration Steps

### Add Thread Layout

**Goal:** Define the UI for the thread screen with header, message list, composer, and unblock layout.  
```xml
<!-- res/layout/activity_thread_message.xml -->
<layout ...>
    <!-- ThreadHeader, MessageList, Composer, UnblockLayout -->
</layout>
```

**File reference:**  
[`activity_thread_message.xml`](https://github.com/cometchat/cometchat-uikit-android/blob/v5/sample_app/app/src/main/res/layout/activity_thread_message.xml)

### Set up ThreadMessageActivity

**Goal:** Initialize the thread screen, retrieve the parent message, and handle blocked users.  
```java
// ThreadMessageActivity.java
public class ThreadMessageActivity extends AppCompatActivity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_thread_message);
        // Initialize header, list, composer; fetch parent message
    }
}
```

**File reference:**  
[`ThreadMessageActivity.java`](https://github.com/cometchat/cometchat-uikit-android/blob/v5/sample_app/app/src/main/java/com/cometchat/sampleapp/ThreadMessageActivity.java)

### Create ThreadMessageViewModel

**Goal:** Use ViewModel to fetch and expose the parent message and manage unblocking logic via LiveData.  
```java
// ThreadMessageViewModel.java
public class ThreadMessageViewModel extends ViewModel {
    // fetchMessageDetails(), unblockUser(), LiveData for UI
}
```

**File reference:**  
[`ThreadMessageViewModel.java`](https://github.com/cometchat/cometchat-uikit-android/blob/v5/sample_app/app/src/main/java/com/cometchat/sampleapp/ThreadMessageViewModel.java)

### Hook Thread Entry from Message List

**Goal:** Allow users to tap any message to transition to the thread view.  
```java
// MessagesActivity.java
binding.messageList.setOnThreadRepliesClick((context, baseMessage, template) -> {
    Intent intent = new Intent(context, ThreadMessageActivity.class);
    intent.putExtra("message_id", baseMessage.getId());
    context.startActivity(intent);
});
```

**File reference:**  
[`MessagesActivity.java`](https://github.com/cometchat/cometchat-uikit-android/blob/v5/sample_app/app/src/main/java/com/cometchat/sampleapp/MessagesActivity.java)

## Implementation Flow

| Step | Action                          | Location                         |
|:-----|---------------------------------|:---------------------------------|
| 1    | Fetch Parent Message            | `ThreadMessageViewModel.java`    |
| 2    | Observe & Display               | `ThreadMessageActivity.java`     |
| 3    | Send Reply                      | `CometChatMessageComposer`       |
| 4    | Live Updates                    | Handled by CometChat UI Kit      |

## Customization Options

- **Styling Components:** Override colors in your theme or use setters on components.  
- **Limit Header Height:** `threadHeader.setMaxHeight(...)`.  
- **Hide Reactions:** `threadHeader.setReactionVisibility(View.GONE)`.  
- **Dynamic Behavior:** Use conditional logic based on `receiverType` in `ThreadMessageActivity`.

## Filtering / Edge Cases

- **Empty Threads:** Display a “No replies yet” state.  
- **Parent Deleted:** Show fallback or disable composer.  
- **Offline Mode:** Queue thread operations or indicate offline status.

## Error Handling / Blocked-User Handling

- **Blocked Users:** In `UserDetailActivity.java`, check `user.isBlockedByMe()` to hide composer and show unblock UI.  
- **Unblock Flow:** `viewModel.unblockUser()` with LiveData observers for progress and feedback.  
- **Progress Indicators:** Show `ProgressBar` during unblock; use `Snackbar` for status messages.

## Group vs. User-Level Differences

| Scenario         | Behavior                                      |
|:-----------------|:----------------------------------------------|
| `USER`           | Compose reply directly if not blocked         |
| `GROUP`          | Check membership before allowing reply        |
| Blocked User     | Hide composer; show unblock layout            |
| Not in Group     | Show join group option before replying        |

## Summary / Feature Matrix

| Feature                 | Component / Method                             |
|:------------------------|:-----------------------------------------------|
| Show thread option      | `setOnThreadRepliesClick(...)`                 |
| Display thread messages | `setParentMessage(...)`                        |
| Show parent message     | `threadHeader.setParentMessage(...)`           |
| Compose reply           | `messageComposer.setParentMessageId(...)`      |
| Block user              | `CometChatUIKit.blockUsers([...])`             |
| Unblock user            | `viewModel.unblockUser()`                      |

## Next Steps & Further Reading

- **Sample App on GitHub:**  
  https://github.com/cometchat/cometchat-uikit-android/tree/v5/sample-app-kotlin  

## Best Practices Recap

- Keep `ViewModel`s lean and lifecycle-aware.  
- Pass `message_id` clearly between activities.  
- Separate UI and logic layers.  
- Minimize header height to focus on replies.  
- Use `LiveData` for reactive UI updates.  

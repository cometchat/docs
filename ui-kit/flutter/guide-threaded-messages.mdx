---
title: "CometChat Flutter UI Kit — Threaded Messages"
sidebarTitle: "Threaded Messages"
---

Enhance your Flutter chat app with threaded messaging by integrating CometChat’s `CometChatThreadedMessageList` and `CometChatMessageList` components to reply to messages in threads and view focused sub-conversations seamlessly.

## Table of Contents

1. [Overview](#overview)  
2. [Prerequisites](#prerequisites)  
3. [Components](#components)  
4. [Integration Steps](#integration-steps)  
   - [Show the “Reply in Thread” Option](#show-the-reply-in-thread-option)  
   - [Navigate to the Thread Screen](#navigate-to-the-thread-screen)  
   - [Send a Threaded Message](#send-a-threaded-message)  
   - [Fetch & Display Thread Replies](#fetch--display-thread-replies)  
5. [Customization Options](#customization-options)  
6. [Filtering / Edge Cases](#filtering--edge-cases)  
7. [Error Handling & Edge Cases](#error-handling--edge-cases)  
8. [Optional Context-Specific Notes](#optional-context-specific-notes)  
9. [Summary / Feature Matrix](#summary--feature-matrix)  
10. [Next Steps & Further Reading](#next-steps--further-reading)

## Overview

The sample app demonstrates how to enable threaded messaging in Flutter using CometChat’s UI Kit:

- Reply to specific messages to start focused sub-conversations.  
- View all replies grouped under the parent message.  
- Seamlessly switch back to the main conversation.

## Prerequisites

- A Flutter project with **CometChat UIKit Flutter v5** installed.  
- Initialized CometChat credentials (`appID`, `region`, `authKey`).  
- Navigation set up (e.g., `lib/messages.dart` to `lib/thread_screen/cometchat_thread.dart`).

## Components

| Component                          | Role                                                         |
|------------------------------------|--------------------------------------------------------------|
| `CometChatMessageList`             | Displays main chat; provides `onThreadRepliesClick` callback.|
| `CometChatThreadedMessageList`     | Fetches and displays replies for a parent message.           |
| `CometChatMessageComposer`         | Sends new messages; pass `parentMessageId` to send replies.  |
| `CometChatThreadedHeader`          | Shows the parent message and thread context at the top.      |

## Integration Steps

### Show the “Reply in Thread” Option

**Goal:** Trigger thread view when tapping the thread icon.  
```dart
CometChatMessageList(
  onThreadRepliesClick: (BaseMessage message) {
    Navigator.push(
      context,
      MaterialPageRoute(
        builder: (_) => CometChatThread(parentMessage: message),
      ),
    );
  },
  // …other props
);
```

**File reference:**  
[`sample_app/lib/messages/messages.dart`](https://github.com/cometchat/cometchat-uikit-flutter/blob/v5/sample_app/lib/messages/messages.dart)

**Why:** Captures the user's intent to view or add to a thread.

### Navigate to the Thread Screen

**Goal:** Display a dedicated thread view.  
```dart
class CometChatThread extends StatelessWidget {
  final BaseMessage parentMessage;

  CometChatThread({required this.parentMessage});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text("Thread")),
      body: Column(
        children: [
          CometChatThreadedHeader(message: parentMessage),
          Expanded(
            child: CometChatThreadedMessageList(
              parentMessageId: parentMessage.id,
            ),
          ),
          CometChatMessageComposer(
            parentMessageId: parentMessage.id,
          ),
        ],
      ),
    );
  }
}
```

**File reference:**  
[`lib/thread_screen/cometchat_thread.dart`](https://github.com/cometchat/cometchat-uikit-flutter/blob/v5/sample_app/lib/thread_screen/cometchat_thread.dart)

**Why:** Provides a focused UI for thread interactions.

### Send a Threaded Message

**Goal:** Send replies in the context of a thread.  
```dart
CometChatMessageComposer(
  parentMessageId: parentMessage.id,
  // …other composer props
);
```

**File reference:**  
[`lib/thread_screen/cometchat_thread.dart`](https://github.com/cometchat/cometchat-uikit-flutter/blob/v5/sample_app/lib/thread_screen/cometchat_thread.dart)

**Why:** Automatically associates new messages with the parent thread.

### Fetch & Display Thread Replies

**Goal:** Retrieve and show all replies under a parent message.  
```dart
MessagesRequest request = MessagesRequestBuilder()
  .setParentMessageId(parentMessageId)
  .build();

request.fetchPrevious().then((replies) {
  // Render these replies in the list
});
```

**File reference:**  
[`lib/thread_screen/cometchat_thread.dart`](https://github.com/cometchat/cometchat-uikit-flutter/blob/v5/sample_app/lib/thread_screen/cometchat_thread.dart)

**Why:** Ensures only relevant threaded messages are shown.

## Customization Options

- **Header Styling:** Customize `CometChatThreadedHeader` appearance (colors, fonts).  
- **List Pagination:** Adjust `limit` in `MessagesRequestBuilder`.  
- **Composer Placeholder:** Change placeholder text based on thread context.

## Filtering / Edge Cases

- **Parent Deleted:** Show a fallback message or disable composer if parent is deleted.  
- **No Replies:** Display an empty state (e.g., “No replies yet”).  
- **Offline Mode:** Queue thread operations or show connectivity indicators.

## Error Handling & Edge Cases

- **Fetch Failures:** Show error UI with retry option on `fetchPrevious` errors.  
- **Send Failures:** Display SnackBar on composer send errors; allow retry.  
- **Loading States:** Show loading indicators during fetch/send operations.

## Optional Context-Specific Notes

- **Group vs. Direct Threads:** Threads work the same for groups and 1:1 chats.  
- **Blocked Users:** Threading respects block state; blocked users cannot send replies.

## Summary / Feature Matrix

| Feature                       | Component / Method                             |
|-------------------------------|------------------------------------------------|
| Show thread option            | `CometChatMessageList.onThreadRepliesClick`    |
| Thread view screen            | `CometChatThread` widget                       |
| Display threaded messages     | `CometChatThreadedMessageList(parentMessageId)`|
| Send threaded message         | `CometChatMessageComposer(parentMessageId)`    |
| Fetch thread replies          | `MessagesRequestBuilder.setParentMessageId`    |

## Next Steps & Further Reading

- **Full Sample App:**  
  https://github.com/cometchat/cometchat-uikit-flutter/tree/v5/sample_app  

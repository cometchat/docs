---
title: "CometChat Flutter UI Kit — Threaded Messages"
sidebarTitle: "Threaded Messages"
---

## 1. Title & TL;DR

- **Title:** CometChat Flutter UI Kit — Threaded Messages  
- **TL;DR:** Enhance your Flutter chat app with threaded messaging by integrating CometChat’s `CometChatThreadedMessageList` and `CometChatMessageList` components to reply to messages in threads and view focused sub-conversations seamlessly.

## 2. Table of Contents

1. [Overview](#3-overview)  
2. [Prerequisites](#4-prerequisites)  
3. [Components](#5-components)  
4. [Integration Steps](#6-integration-steps)  
   4.1 [Show the “Reply in Thread” Option](#61-show-the-reply-in-thread-option)  
   4.2 [Navigate to the Thread Screen](#62-navigate-to-the-thread-screen)  
   4.3 [Send a Threaded Message](#63-send-a-threaded-message)  
   4.4 [Fetch & Display Thread Replies](#64-fetch--display-thread-replies)  
5. [Customization Options](#7-customization-options)  
6. [Filtering / Edge Cases](#8-filtering--edge-cases)  
7. [Error Handling & Edge Cases](#9-error-handling--edge-cases)  
8. [Optional Context-Specific Notes](#10-optional-context-specific-notes)  
9. [Summary / Feature Matrix](#11-summary--feature-matrix)  
10. [Next Steps & Further Reading](#12-next-steps--further-reading)  

## 3. Overview

The sample app demonstrates how to enable threaded messaging in Flutter using CometChat’s UI Kit:

- Reply to specific messages to start focused sub-conversations.  
- View all replies grouped under the parent message.  
- Seamlessly switch back to the main conversation.

## 4. Prerequisites

- A Flutter project with **CometChat UIKit Flutter v5** installed.  
- Initialized CometChat credentials (`appID`, `region`, `authKey`).  
- Navigation set up (e.g., `lib/messages.dart` to `lib/thread_screen/cometchat_thread.dart`).

## 5. Components

| Component                          | Role                                                         |
|------------------------------------|--------------------------------------------------------------|
| `CometChatMessageList`             | Displays main chat; provides `onThreadRepliesClick` callback.|
| `CometChatThreadedMessageList`     | Fetches and displays replies for a parent message.           |
| `CometChatMessageComposer`         | Sends new messages; pass `parentMessageId` to send replies.  |
| `CometChatThreadedHeader`          | Shows the parent message and thread context at the top.      |

## 6. Integration Steps

### 6.1 Show the “Reply in Thread” Option

**Goal:** Trigger thread view when tapping the thread icon.  
```dart
CometChatMessageList(
  onThreadRepliesClick: (BaseMessage message) {
    Navigator.push(
      context,
      MaterialPageRoute(
        builder: (_) => CometChatThread(parentMessage: message),
      ),
    );
  },
  // …other props
);
```
<small>File: `sample_app/lib/messages/messages.dart`</small>  
**Why:** Captures the user's intent to view or add to a thread.

### 6.2 Navigate to the Thread Screen

**Goal:** Display a dedicated thread view.  
```dart
class CometChatThread extends StatelessWidget {
  final BaseMessage parentMessage;

  CometChatThread({required this.parentMessage});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text("Thread")),
      body: Column(
        children: [
          CometChatThreadedHeader(message: parentMessage),
          Expanded(
            child: CometChatThreadedMessageList(
              parentMessageId: parentMessage.id,
            ),
          ),
          CometChatMessageComposer(
            parentMessageId: parentMessage.id,
          ),
        ],
      ),
    );
  }
}
```
<small>File: `sample_app/lib/thread_screen/cometchat_thread.dart`</small>  
**Why:** Provides a focused UI for thread interactions.

### 6.3 Send a Threaded Message

**Goal:** Send replies in the context of a thread.  
```dart
CometChatMessageComposer(
  parentMessageId: parentMessage.id,
  // …other composer props
);
```
<small>File: `cometchat_thread.dart`</small>  
**Why:** Automatically associates new messages with the parent thread.

### 6.4 Fetch & Display Thread Replies

**Goal:** Retrieve and show all replies under a parent message.  
```dart
MessagesRequest request = MessagesRequestBuilder()
  .setParentMessageId(parentMessageId)
  .build();

request.fetchPrevious().then((replies) {
  // Render these replies in the list
});
```
<small>File: `cometchat_thread.dart`</small>  
**Why:** Ensures only relevant threaded messages are shown.

## 7. Customization Options

- **Header Styling:** Customize `CometChatThreadedHeader` appearance (colors, fonts).  
- **List Pagination:** Adjust `limit` in `MessagesRequestBuilder`.  
- **Composer Placeholder:** Change placeholder text based on thread context.

## 8. Filtering / Edge Cases

- **Parent Deleted:** Show a fallback message or disable composer if parent is deleted.  
- **No Replies:** Display an empty state (e.g., “No replies yet”).  
- **Offline Mode:** Queue thread operations or show connectivity indicators.

## 9. Error Handling & Edge Cases

- **Fetch Failures:** Show error UI with retry option on `fetchPrevious` errors.  
- **Send Failures:** Display SnackBar on composer send errors; allow retry.  
- **Loading States:** Show loading indicators during fetch/send operations.

## 10. Optional Context-Specific Notes

- **Group vs. Direct Threads:** Threads work the same for groups and 1:1 chats.  
- **Blocked Users:** Threading respects block state; blocked users cannot send replies.

## 11. Summary / Feature Matrix

| Feature                       | Component / Method                             |
|-------------------------------|------------------------------------------------|
| Show thread option            | `CometChatMessageList.onThreadRepliesClick`    |
| Thread view screen            | `CometChatThread` widget                       |
| Display threaded messages     | `CometChatThreadedMessageList(parentMessageId)`|
| Send threaded message         | `CometChatMessageComposer(parentMessageId)`    |
| Fetch thread replies          | `MessagesRequestBuilder.setParentMessageId`    |

## 12. Next Steps & Further Reading

- **Full Sample App:**  
  https://github.com/cometchat/cometchat-uikit-flutter/tree/v5/sample_app  
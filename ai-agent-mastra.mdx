---
title: "Create an AI Agent with Mastra (CometChat)"
sidebarTitle: "Create AI Agent (Mastra)"
description: "Connect a Mastra agent to CometChat, customize it with Chat Builder, and ship it as React UI Kit code or a Chat Widget."
---

<Callout>
**Developer Preview**: AI Agents currently support **Mastra**. OpenAI, Agno, and other providers are coming soon.
</Callout>

## What you’ll build

- A **Mastra** agent with tools/actions  
- The same agent **connected to CometChat** (Agent ID + Deployment URL)  
- A **customized chat experience** using **Chat Builder**  
- An export to **React UI Kit code** _or_ **Chat Widget** for integration

---

## Prerequisites

- A CometChat account and an app: **[Create App](https://app.cometchat.com/apps)**
- A Mastra agent (ID + public Deployment URL) — follow Mastra’s quickstart:  
  **[Mastra Quickstart](https://mastra.ai/agents)**

---

## Step 1 — Create your CometChat app

<Steps>
  <Step title="Create or open an app">
    Sign in at <b><a href="https://app.cometchat.com/apps">app.cometchat.com</a></b>. Create a new app or open an existing one.
  </Step>
  <Step title="Copy credentials">
    Note your <b>App ID</b>, <b>Region</b>, and <b>Auth Key</b> (needed if you export the Chat Widget later).
  </Step>
</Steps>

---

## Step 2 — Connect your Mastra Agent

Navigate to **AI Agent → Get Started** and then **AI Agents → Add Agent**.

<Steps>
  <Step title="Choose provider">
    Select **Mastra**.
  </Step>
  <Step title="Basic details">
    Provide:
    - **Name** and optional **Icon**
    - (Optional) **Greeting** and **Introductory Message**
    - (Optional) **Suggested messages**
  </Step>
  <Step title="Mastra configuration">
    Paste the following from your Mastra deployment:
    - **Mastra Agent ID**
    - **Deployment URL** (public URL that CometChat can reach)
  </Step>
  <Step title="Save & enable">
    Click **Save**, then ensure the agent’s toggle is **ON** in **AI Agents** list.
  </Step>
</Steps>

> **Tip:** If you update your Mastra agent later (prompts, tools, routing), you won’t need to re-connect it in CometChat—just keep the **Agent ID** and **Deployment URL** the same.

---

## (Optional) Step 3 — Define Frontend Actions

<Steps>
  <Step title="Add an action">
    Go to <b>AI Agent → Actions</b> and click <b>Add</b> to create a frontend action your agent can call (e.g., “Open Product,” “Start Demo,” “Book Slot”).
  </Step>
  <Step title="Define fields">
    Include:
    <ul>
      <li><b>Display Name</b> — Shown to users (e.g., “Open Product Page”).</li>
      <li><b>Execution Text</b> — How the agent describes running it (e.g., “Opening product details for the user.”).</li>
      <li><b>Name</b> — A unique, code‑friendly key (e.g., <code>open_product</code>).</li>
      <li><b>Description</b> — What the tool does and when to use it.</li>
      <li><b>Parameters</b> — JSON Schema describing inputs (the agent will fill these).</li>
    </ul>
  </Step>
  <Step title="Validate inputs (schema)">
    Example parameters JSON:

```json
{
  "type": "object",
  "required": ["productId"],
  "properties": {
    "productId": {
      "type": "string",
      "description": "The internal product ID to open"
    },
    "utm": {
      "type": "string",
      "description": "Optional tracking code"
    }
  }
}
```
  </Step>
  <Step title="Handle in your UI">
    At runtime, listen for tool calls and execute them client‑side (e.g., route changes, modals, highlights).
  </Step>
</Steps>

---

## Step 4 — Customize with Chat Builder

<Steps>
  <Step title="Open Chat Builder">
    Launch <b>Chat Builder</b> in your CometChat dashboard to design the experience visually.
  </Step>
  <Step title="Attach your agent">
    Select the <b>Mastra</b> agent you connected in Step 2.
  </Step>
  <Step title="Tune the experience">
    <ul>
      <li>Enable/disable features (typing indicators, attachments, message reactions, etc.).</li>
      <li>Tweak theme, brand colors, and layout.</li>
    </ul>
  </Step>
  <Step title="Preview & iterate">
    Use live preview to test and refine before export.
  </Step>
</Steps>

<Callout>
<b>Learn more</b><br/>
• Chat Builder (React UI Kit): https://www.cometchat.com/docs/ui-kit/react/builder-integration<br/>
• Chat Widget overview: https://www.cometchat.com/docs/widget/overview<br/>
• Live preview: https://preview.cometchat.com/
</Callout>

---

## Step 5 — Export & Integrate

You have two export paths—pick the one that fits your app.

### A) Export **React UI Kit** code

<Steps>
  <Step title="Export from Chat Builder">
    Export a ready‑to‑run React UI (components + config) from Chat Builder.
  </Step>
  <Step title="Integrate in your app">
    Import into your existing React app. Follow the generated README for environment variables.
  </Step>
  <Step title="Wire authentication">
    Use your app’s <code>appID</code>, <code>region</code>, and an auth mechanism (<code>authKey</code> for dev, or your own token service in prod).
  </Step>
</Steps>

### B) Export **Chat Widget** (HTML/JS)

<Steps>
  <Step title="Embed the widget">
    Add a docked widget with minimal code:

```html
<div id="cometchat"></div>
<script src="https://widget-js.cometchat.io/v3/cometchatwidget.js"></script>
<script>
  CometChatWidget.init({
    appID: "YOUR_APP_ID",
    region: "YOUR_REGION"
  }).then(() => {
    // For dev/testing you can use authKey; for production use a secure token service.
    CometChatWidget.login({
      uid: "USER_ID",
      authToken: "AUTH_TOKEN"
    }).then(() => {
      CometChatWidget.launch({
        widgetID: "WIDGET_ID_FROM_CHAT_BUILDER_EXPORT",
        target: "#cometchat",
        docked: true
      });
    });
  });
</script>
```
  </Step>
</Steps>

> **Note:** The **Mastra agent** you connected in Step 2 is already part of the exported configuration, so your end-users will chat with that agent immediately.

---

## Quick Mastra Setup (Reference)

<AccordionGroup>
  <Accordion title="Define an agent with tools">
    If you haven’t deployed a Mastra agent yet, here’s the minimal shape. Use the Mastra quickstart for exact commands and project layout.

```ts
// mastra/agent.ts
import { defineAgent } from "mastra"; // refer to Mastra docs for exact import

export const supportAgent = defineAgent({
  name: "My Agent 1",
  instructions: `
You are a helpful support agent for Acme. Use tools when appropriate.
`,
  tools: [
    {
      name: "open_product",
      description: "Open a product by ID in the UI",
      parameters: {
        type: "object",
        required: ["productId"],
        properties: { productId: { type: "string" } }
      },
    },
  ],
});
```

  </Accordion>
  <Accordion title="Expose a public HTTP endpoint">

```ts
// server.ts
import express from "express";
import { supportAgent } from "./mastra/agent";

const app = express();
app.use(express.json());

app.post("/mastra/agent", async (req, res) => {
  const { messages } = req.body; // follow Mastra’s expected schema
  const result = await supportAgent.respond({ messages });
  res.json(result);
});

app.listen(process.env.PORT || 3000, () => {
  console.log("Mastra agent running");
});
```

  </Accordion>
  <Accordion title="Deploy & copy IDs">
    Deploy this (e.g., Vercel, Render, Fly, your infra) and copy the <b>public URL</b> as your <b>Deployment URL</b>. Also copy your <b>Mastra Agent ID</b> from your Mastra dashboard/config.
    <br/>
    <br/>
    <b>Docs</b>: https://mastra.ai/agents
  </Accordion>
</AccordionGroup>

---

## Test your setup

<Steps>
  <Step title="Enable the agent">In <b>AI Agents</b>, ensure your Mastra agent shows <b>Enabled</b>.</Step>
  <Step title="Preview in Chat Builder">Open <b>Chat Builder</b> and start a preview session.</Step>
  <Step title="Validate conversation">Send a message; confirm the agent responds.</Step>
  <Step title="Test actions">Trigger a <b>Frontend Action</b> and verify your UI handles the tool call.</Step>
</Steps>

---

## Troubleshooting

<AccordionGroup>
  <Accordion title="Agent not responding">
    <ul>
      <li>Verify your <b>Deployment URL</b> is publicly reachable (no VPN/firewall).</li>
      <li>Check server logs for 4xx/5xx errors.</li>
    </ul>
  </Accordion>
  <Accordion title="Tool call not executed">
    <ul>
      <li>Confirm the Action’s <b>Name</b> in CometChat exactly matches the tool name your UI listens for.</li>
      <li>Validate the <b>Parameters</b> JSON Schema; the agent uses this to fill inputs.</li>
    </ul>
  </Accordion>
  <Accordion title="Auth issues in exports">
    <ul>
      <li>Use <code>authKey</code> only for development. For production, implement a <b>secure token</b> flow for user login.</li>
    </ul>
  </Accordion>
</AccordionGroup>

---

## Next steps

<AccordionGroup>
  <Accordion title="Add more Actions">
    Expand capabilities (calendar, payments, navigation) with additional frontend actions and matching UI handlers.
  </Accordion>
  <Accordion title="Localize & theme">
    Localize responses and refine the UI theme in Chat Builder for brand consistency and accessibility.
  </Accordion>
  <Accordion title="Analytics & observability">
    Wire analytics/observability to measure agent resolution, time‑to‑answer, and CSAT.
  </Accordion>
</AccordionGroup>

---

## Screenshots (add to repo/media and reference)

<Cards>
  <Card title="Get Started (Overview)">
    <Img src="/images/ai-agent-get-started.png" alt="CometChat AI Agent Get Started" />
  </Card>
  <Card title="AI Agents List">
    <Img src="/images/ai-agents-list.png" alt="AI Agents list with Mastra agent enabled" />
  </Card>
  <Card title="Connect Mastra Agent">
    <Img src="/images/ai-agent-connect-form.png" alt="Connect Agent form" />
  </Card>
  <Card title="Create Frontend Action">
    <Img src="/images/ai-actions-empty.png" alt="AI Tools empty state" />
    <Img src="/images/ai-actions-create.png" alt="Create Tool form" />
  </Card>
</Cards>
